# NIPT数学建模竞赛题目解决方案

## 项目概述

本项目针对2025年高教社杯全国大学生数学建模竞赛C题"NIPT的时点选择与胎儿的异常判定"提供完整的数学建模解决方案。

## 问题分析

### 数据概览
- 总样本数：1082个
- 样本类型：全部为男胎（Y染色体浓度数据完整）
- 异常案例：126个（基于染色体非整倍体和健康状况）
- 主要异常类型：T21（唐氏综合征）、T18（爱德华氏综合征）、T13（帕陶氏综合征）

## 解决方案

### 问题1：Y染色体浓度相关性分析
**文件：** `problem1_correlation_analysis.py`

**主要发现：**
- 孕周数与Y染色体浓度呈显著正相关（r=0.1266, p<0.001）
- BMI与Y染色体浓度呈显著负相关（r=-0.1513, p<0.001）
- 体重与Y染色体浓度相关性最强（r=-0.1806, p<0.001）
- 多元线性回归模型R²=0.0715，模型整体显著（p<0.001）

**关键结论：**
- 胎儿Y染色体浓度随孕周增加而上升
- 母体BMI和体重对Y染色体浓度有负面影响
- 建立了显著的多因素预测模型

### 问题2：BMI分组与最佳NIPT时点
**文件：** `problem2_bmi_timing.py`

**最优BMI分组方案：**
1. **组0** (BMI 20.70-29.75): 最佳检测时间12.2周，检测率26.9%
2. **组1** (BMI 29.76-31.25): 最佳检测时间12.2周，检测率29.7%
3. **组2** (BMI 31.26-33.33): 最佳检测时间12.2周，检测率25.0%
4. **组3** (BMI 33.34-44.98): 最佳检测时间12.5周，检测率36.9%

**风险评估：**
- 高BMI组（组3）风险评分最低（8.31），检测率最高
- 检测误差对结果影响：20%误差率下检测率下降约10%

### 问题3：多因素综合分析
**文件：** `problem3_multifactor.py`

**重要特征排序：**
1. 体重（重要性：0.285）
2. Y染色体浓度最大值（重要性：0.263）
3. 孕妇BMI（重要性：0.134）

**优化分组方案：**
- **聚类0** (BMI 28.3-39.2, 年龄21-32): 13.7周，87.6%检测率
- **聚类1** (BMI 29.8-45.0, 年龄22-37): 22.0周，80.8%检测率
- **聚类2** (BMI 27.9-38.5, 年龄30-43): 13.4周，80.3%检测率
- **聚类3** (BMI 20.7-34.9, 年龄22-33): 13.3周，67.9%检测率

### 问题4：胎儿异常判定方法
**文件：** `problem4_female_abnormality.py`

**检测标准：**
1. **Z值阈值：**
   - 21号、18号、13号染色体：Z值 > 3.0
   - X染色体：Z值 < -3.0

2. **GC含量正常范围：**
   - 总体GC含量：40%-60%
   - 各染色体GC含量：35%-65%

**显著特征：**
1. 年龄（p<0.001）
2. 18号染色体Z值（p=0.0047）
3. 21号染色体Z值（p=0.0305）
4. 13号染色体Z值（p=0.0473）

**风险分级：**
- 高风险（1.9%）：建议有创诊断
- 中等风险（2.3%）：建议遗传咨询
- 低风险（7.0%）：建议随访NIPT
- 正常（88.7%）：常规产前护理

## 技术方法

### 统计方法
- Pearson相关分析
- 多元线性回归
- t检验
- 机器学习特征重要性分析

### 机器学习方法
- 随机森林回归/分类
- 逻辑回归
- 支持向量机
- K-means聚类

### 优化方法
- 风险函数最小化
- 多目标优化
- 交叉验证

## 模型性能

### 问题1模型
- 相关分析：多个显著相关特征（p<0.05）
- 回归模型：R²=0.0715，F检验显著

### 问题2模型
- 分组准确性：量化风险评分方法
- 时点优化：基于风险最小化原则

### 问题3模型
- 预测模型：随机森林R²=0.827（训练集）
- 聚类分析：多因素综合分组

### 问题4模型
- 综合检测准确率：92.98%
- 机器学习AUC：0.78（随机森林）
- 规则系统准确率：54.62%

## 实际应用建议

### 临床指导
1. **早期检测**：建议在12-13周进行NIPT检测
2. **个性化时点**：根据BMI和年龄调整检测时间
3. **风险分层**：建立多级风险评估体系
4. **质量控制**：监控GC含量和Z值指标

### 检测流程
1. 收集孕妇基本信息（BMI、年龄、身高、体重）
2. 根据分组确定最佳检测时点
3. 执行NIPT检测
4. 应用综合判定算法
5. 根据风险等级提供相应建议

## 文件说明

- `problem1_correlation_analysis.py`：问题1解决方案
- `problem2_bmi_timing.py`：问题2解决方案  
- `problem3_multifactor.py`：问题3解决方案
- `problem4_female_abnormality.py`：问题4解决方案
- `C题_text.txt`：题目原文
- `README.md`：项目说明

## 运行环境

```bash
pip install pandas numpy matplotlib seaborn scikit-learn scipy openpyxl
```

## 使用方法

```bash
python3 problem1_correlation_analysis.py
python3 problem2_bmi_timing.py  
python3 problem3_multifactor.py
python3 problem4_female_abnormality.py
```

每个脚本将生成相应的分析结果和可视化图表。

## 创新点

1. **多维度风险评估**：结合统计学和机器学习方法
2. **个性化检测时点**：基于多因素优化的时间选择
3. **综合判定系统**：融合规则和ML的检测方法
4. **误差敏感性分析**：考虑检测误差的影响评估

## 结论

本解决方案提供了完整的NIPT时点选择和异常判定方法，通过科学的数学建模和统计分析，为临床实践提供了实用的指导方案。模型具有良好的预测性能和实际应用价值。